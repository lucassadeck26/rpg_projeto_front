{"ast":null,"code":"var _jsxFileName = \"/home/lucas/rpg_project/frontend/rpg_projeto_front/src/components/contexts/UserContext.tsx\",\n    _s = $RefreshSig$();\n\nimport { createContext, useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport api from \"../../services/api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const UserContext = /*#__PURE__*/createContext({});\n\nconst UserProvider = _ref => {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [teste, setTeste] = useState();\n  const [display, setDisplay] = useState(false);\n  const [validation, setValidation] = useState(false);\n  const [user, setUser] = useState();\n  const [produtos, setProdutos] = useState();\n  const [loading, setLoading] = useState(true);\n  const [isModalAddVisible, setIsModalAddVisible] = useState(false);\n  const [isModalDeleteVisible, setIsModalDeleteVisible] = useState(false);\n  const navigate = useNavigate();\n\n  async function loadUser() {\n    const token = localStorage.getItem(\"@TOKEN\");\n    const emailCliente = localStorage.getItem(\"@CLIENTEMAIL\");\n\n    if (token) {\n      try {\n        api.defaults.headers.common.authorization = `Bearer ${token}`;\n        const {\n          data\n        } = await api.get(\"/clientes\");\n        console.log(`o valor de email cliente  é ${emailCliente}`);\n        data.forEach(e => {\n          if (emailCliente === e.email) {\n            console.log(`o valor realmente do email é ${e.email} `);\n            setUser(e);\n          }\n        }); //ssetProdutos()\n      } catch (error) {\n        console.error(error);\n      }\n    }\n\n    setLoading(false);\n  }\n\n  useEffect(() => {\n    loadUser();\n  }, []);\n\n  const handleFormLogin = data => {\n    api.post(\"/login\", { ...data\n    }).then(res => {\n      setValidation(true);\n      setDisplay(true);\n      setUser(res.data.user);\n      window.localStorage.clear();\n      window.localStorage.setItem(\"@TOKEN\", res.data.token);\n      window.localStorage.setItem(\"@CLIENTEMAIL\", data.email);\n      navigate(\"/home\", {\n        replace: true\n      });\n      window.location.reload();\n    }).catch(err => {\n      console.log(`deu erro de ${err}`);\n      setValidation(false);\n      setDisplay(true);\n      window.localStorage.clear();\n    });\n  };\n\n  const handleFormRegister = Data => {\n    console.log(Data);\n    api.post(\"/clientes\", { ...Data\n    }).then(res => {\n      console.log(`o valor de data é ${res.data}`);\n      setValidation(true);\n      setDisplay(true);\n      navigate(\"/login\", {\n        replace: true\n      });\n    }).catch(err => {\n      console.log(err);\n      setValidation(false);\n      setDisplay(true);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n    value: {\n      produtos,\n      setProdutos,\n      display,\n      validation,\n      setDisplay,\n      setValidation,\n      handleFormLogin,\n      handleFormRegister,\n      user,\n      setUser,\n      loading,\n      setLoading,\n      isModalAddVisible,\n      setIsModalAddVisible,\n      isModalDeleteVisible,\n      setIsModalDeleteVisible\n    },\n    children: [\" \", children]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 170,\n    columnNumber: 5\n  }, this);\n};\n\n_s(UserProvider, \"PzJjXXj6+7miHvtBgnr6kRuYH8A=\", false, function () {\n  return [useNavigate];\n});\n\n_c = UserProvider;\nexport default UserProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"UserProvider\");","map":{"version":3,"names":["createContext","useEffect","useState","useNavigate","api","UserContext","UserProvider","children","teste","setTeste","display","setDisplay","validation","setValidation","user","setUser","produtos","setProdutos","loading","setLoading","isModalAddVisible","setIsModalAddVisible","isModalDeleteVisible","setIsModalDeleteVisible","navigate","loadUser","token","localStorage","getItem","emailCliente","defaults","headers","common","authorization","data","get","console","log","forEach","e","email","error","handleFormLogin","post","then","res","window","clear","setItem","replace","location","reload","catch","err","handleFormRegister","Data"],"sources":["/home/lucas/rpg_project/frontend/rpg_projeto_front/src/components/contexts/UserContext.tsx"],"sourcesContent":["import {\n  createContext,\n  ReactNode,\n  SetStateAction,\n  useContext,\n  useEffect,\n  useState,\n} from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { string } from \"yup\";\nimport { IFormRegisterRegister } from \"../../pages/Register\";\nimport api from \"../../services/api\";\nimport { ToastContext } from \"./ToastContext\";\n\ninterface IUserProviderProps {\n  children: ReactNode;\n}\n\nexport interface ILoginForm {\n  email: string;\n  password: string;\n}\n\ninterface ITech {\n  id: string;\n  title: string;\n  status: string;\n  created_at: Date;\n  updated_at: Date;\n}\n\nexport interface IProdutos {\n  descricao: string;\n  numero_paginas: number;\n  preco: number;\n  imagem: string;\n  isPromo: boolean;\n}\n\nexport interface ICARTPRODUTOS {\n  produtos: IProdutos[];\n}\n\ninterface IUser {\n  id: string;\n  name: string;\n  course_module?: string;\n  email: string;\n  bio: string;\n  contact: string;\n  avatar_url: string;\n  techs: ITech[];\n  created_at: Date;\n  updated_at: Date;\n}\n\nexport interface IProdutos {\n  descricao: string;\n  numero_paginas: number;\n  preco: number;\n  imagem: string;\n  isPromo: boolean;\n}\n\ninterface IUserContext {\n  display: boolean;\n  validation: boolean;\n  setDisplay: React.Dispatch<SetStateAction<boolean>>;\n  setValidation: React.Dispatch<SetStateAction<boolean>>;\n  handleFormLogin: (data: ILoginForm) => void;\n  handleFormRegister: (data: IFormRegisterRegister) => void;\n  user: IUser | undefined;\n  produtos: IProdutos | undefined;\n  setProdutos: React.Dispatch<SetStateAction<IProdutos | undefined>>;\n  setUser: React.Dispatch<SetStateAction<IUser | undefined>>;\n  loading: boolean;\n  setLoading: React.Dispatch<SetStateAction<boolean>>;\n  isModalAddVisible: boolean;\n  setIsModalAddVisible: React.Dispatch<SetStateAction<boolean>>;\n  isModalDeleteVisible: boolean;\n  setIsModalDeleteVisible: React.Dispatch<SetStateAction<boolean>>;\n}\n\nexport const UserContext = createContext<IUserContext>({} as IUserContext);\n\nconst UserProvider = ({ children }: IUserProviderProps) => {\n  const [teste, setTeste] = useState();\n  const [display, setDisplay] = useState(false);\n  const [validation, setValidation] = useState(false);\n  const [user, setUser] = useState<IUser>();\n  const [produtos, setProdutos] = useState<IProdutos>();\n  const [loading, setLoading] = useState(true);\n  const [isModalAddVisible, setIsModalAddVisible] = useState(false);\n  const [isModalDeleteVisible, setIsModalDeleteVisible] = useState(false);\n  const navigate = useNavigate();\n\n  async function loadUser() {\n    const token = localStorage.getItem(\"@TOKEN\");\n    const emailCliente = localStorage.getItem(\"@CLIENTEMAIL\");\n\n    if (token) {\n      try {\n        api.defaults.headers.common.authorization = `Bearer ${token}`;\n\n        const { data } = await api.get(\"/clientes\");\n        console.log(`o valor de email cliente  é ${emailCliente}`);\n\n        data.forEach((e: any) => {\n          if (emailCliente === e.email) {\n            console.log(`o valor realmente do email é ${e.email} `);\n            setUser(e);\n          }\n        });\n\n        //ssetProdutos()\n      } catch (error) {\n        console.error(error);\n      }\n    }\n    setLoading(false);\n  }\n\n  useEffect(() => {\n    loadUser();\n  }, []);\n\n  const handleFormLogin = (data: ILoginForm) => {\n    api\n      .post(\"/login\", { ...data })\n      .then((res) => {\n        setValidation(true);\n        setDisplay(true);\n        setUser(res.data.user);\n        window.localStorage.clear();\n        window.localStorage.setItem(\"@TOKEN\", res.data.token);\n        window.localStorage.setItem(\"@CLIENTEMAIL\", data.email);\n\n        navigate(\"/home\", { replace: true });\n        window.location.reload();\n      })\n      .catch((err) => {\n        console.log(`deu erro de ${err}`);\n\n        setValidation(false);\n        setDisplay(true);\n        window.localStorage.clear();\n      });\n  };\n\n  const handleFormRegister = (Data: IFormRegisterRegister) => {\n    console.log(Data);\n    api\n      .post(\"/clientes\", { ...Data })\n\n      .then((res) => {\n        console.log(`o valor de data é ${res.data}`);\n\n        setValidation(true);\n        setDisplay(true);\n        navigate(\"/login\", { replace: true });\n      })\n      .catch((err) => {\n        console.log(err);\n        setValidation(false);\n        setDisplay(true);\n      });\n  };\n\n  return (\n    <UserContext.Provider\n      value={{\n        produtos,\n        setProdutos,\n        display,\n        validation,\n        setDisplay,\n        setValidation,\n        handleFormLogin,\n        handleFormRegister,\n        user,\n        setUser,\n        loading,\n        setLoading,\n        isModalAddVisible,\n        setIsModalAddVisible,\n        isModalDeleteVisible,\n        setIsModalDeleteVisible,\n      }}\n    >\n      {\" \"}\n      {children}\n    </UserContext.Provider>\n  );\n};\nexport default UserProvider;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}